<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Meddy</title>
<style media="screen">
html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}body{margin:0;}article,aside,footer,header,nav,section{display:block;}h1{font-size:2em;margin:0.67em 0;}figcaption,figure,main{display:block;}figure{margin:1em 40px;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace, monospace;font-size:1em;}a{background-color:transparent;-webkit-text-decoration-skip:objects;}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}b,strong{font-weight:inherit;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace, monospace;font-size:1em;}dfn{font-style:italic;}mark{background-color:#ff0;color:#000;}small{font-size:0.8em;}sub,sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}audio,video{display:inline-block;}audio:not([controls]){display:none;height:0;}img{border-style:none;}svg:not(:root){overflow:hidden;}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:1em;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,html [type="button"], [type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{display:inline-block;vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details, menu{display:block;}summary{display:list-item;}canvas{display:inline-block;}template{display:none;}[hidden]{display:none;}body{margin:0;font-family:"Bookman Old Style", "Callisto MT", Bookman, "Goudy Old Style", Garamond, serif;background-color:#fdfdfd;font-size:18px;line-height:1.4;max-width:900px;padding:0.83em;color:#292929;}h1, h2, h3, h4, h5, h6{color:#404040;font-weight:800;padding-left:0;}h1, h2, h3, h4, h5, h6{font-family:"Century Gothic", Verdana, "Sans";}h1, h2, h3, h4, p{margin-bottom:0.88em;}h1{font-size:1.8em;margin:0.27em 0 1.11em 0;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:1em;background-color:inherit;}h2{font-size:1.44em;margin:0.55em 0 0.55em 0;padding-top:0.55em;border-bottom:1px solid Silver;}h3{margin:0;margin-top:0.55em;font-size:1.22em;}nav h3{font-size:0.88em;margin-left:0.83em;margin-bottom:0.27em;}h4{font-size:1em;margin:0;margin-top:0.55em;}h5{font-size:0.94em;margin:0;margin-top:0.66em;padding:0;}h6{font-size:0.88em;margin:0;margin-top:0.66em;padding:0;}a{color:#0099ff;margin:0;padding:0;vertical-align:baseline;}a:visited{color:purple;}a.autoheader_anchor{text-decoration:none;}ul{list-style-type:disc;}ul, ol{padding:0;margin:0;}dd{padding-top:0.25em;}p.first_dd{padding-top:0.25em;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:1.38em;margin-bottom:0.55em;}ul > li{margin-left:1.11em;}li ul{margin-left:0.55em;}li ul{margin-left:0.27em;}li p{padding:1px 0 0 0;margin:0.55em 0 0.27em 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:0.44em 0 0 0;margin:0;}pre{overflow:scroll;padding:0.55em 0.27em;margin:0.55em 0 0.55em 0 !important;background-color:#faebd7;color:#3e3e3e;border:1px Silver dashed;display:block;font-family:APLFont, monospace;font-weight:400;}pre > code{line-height:1.2;border:0;padding:0;margin:0;background-color:inherit;color:inherit;font-weight:inherit;}a code{padding:0;font-size:1em;}nav code{background-color:inherit;font-weight:400;color:inherit;}code{font-family:APLFont, monospace;background-color:#e7e7e7;color:Black;font-weight:800;line-height:1.2;font-size:0.88em;margin:0;color:#950000;padding:0 0.16em;}tbody tr:nth-child(even){background-color:#F0F0F0;}th{background-color:#E6E6E6;color:black;}th, td{padding:0.16em 0.55em;}table{border-color:Black;margin:1.11em 0 1.11em 0;border:2px black;border-collapse:collapse;font-family:APLFont;font-size:0.88em;line-height:1.2;border:1px solid Gray;}li > table{margin:0.55em 0 0.55em 0;}tr{margin:1.11em;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:0.27em solid silver;padding-left:0.27em;margin:0.83em 0.27em 0.83em 0.55em;}blockquote ul li{margin-left:1.38em;}blockquote ol li{margin-left:1.38em;}li > blockquote{margin-left:0;}nav{background-color:#f5f5f5;border:1px solid Black;padding:0.55em;margin:0.55em;margin-right:0;box-shadow:0.27em 0.27em 0.27em Gray;overflow:hidden;}nav#main_nav{position:fixed;top:0;right:0.55em;float:none;width:auto;}nav#main_nav_no_collapse li{font-size:0.77rem;}nav#main_nav_no_collapse li{line-height:1.5;}nav ul{list-style-type:none;margin:0 0 0.11em 0;padding:0;}nav a:visited{color:black;}nav ul li{margin-bottom:0.16em;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:0.75rem;line-height:1.3;padding:0;margin-top:0;margin-bottom:0;margin-left:0.83em;}nav p{font-weight:bold;font-size:0.75rem;padding-top:0;}dl{margin-top:0.1em;margin-bottom:0.1em;}dt{margin-top:0.75em;margin-bottom:0.1em;font-weight:800;}label#hide_toc_label{font-size:0.8em;}.toc-container{position:relative;height:auto;}div.toc-container h1{font-size:0.88em;margin:0.27em 0 0.27em 0;}[type="checkbox"]{position:absolute;left:-9999px;}label{display:block;width:100%;height:1.1em;cursor:pointer;top:0;padding-left:1.1em;}label:before{content:'Table of contents \25BC';font-weight:bold;font-size:90%;padding-bottom:0;}[type="checkbox"] ~ div{display:none;}[type="checkbox"]:checked ~ div{display:block;margin-top:1.1em;}[type="checkbox"]:checked + label{top:100%;}[type="checkbox"]:checked + label:before{content:'Table of contents ▲';}div#footnotes_div p{line-height:1;padding-bottom:0;padding-top:0;}div#footnotes_div ol{padding-top:0;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_display{display:none;}.red{color:red;}img{margin-top:0.55em;margin-bottom:0.27em;}div.leanpub{padding:0.83em 0.55em 1.11em 0;margin:0.55em 0 0 0.27em;overflow:auto;}div.leanpub_A{border:1px solid black;background-color:#f1f1f1;padding:0.55em;margin:1.11em 0 0.83em 0;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:0.27em 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 1.11em 0.27em 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub img{float:left;padding:0;margin:0.55em 1.11em 0 0;clear:both;}div.leanpub tbody *{background-color:transparent;}div.leanpub p{padding:0.17em 0 0 0;margin:0;}span.leanpub_code{color:Red;}div.leanpub p{display:block;padding:0.44em 0 0 0;}div.leanpub > div{margin-left:2.27em;}
</style>
<style media="print">
@page{margin:25mm 20mm 25mm 20mm;}body{font-family:"Bookman Old Style", "Callisto MT", Bookman,"Goudy Old Style", Garamond, serif;font-size:9pt;line-height:1.2;}h1{font-size:170%;}h2{font-size:110%;}h3{font-size:110%;}h4{font-size:105%;}h5{font-size:100%;}h6{font-size:95%;}h1{margin:0 0 20pt 0;}h2{margin:15pt 0 3pt 0;}h3{margin:10pt 0 0pt 0;}h4{margin:10pt 0 0pt 0;}h5{margin:9pt 0 0pt 0;}h6{margin:9pt 0 0pt 0;}h1, h2, h3, h4, h5, h6{color:black;font-family:"Century Gothic", Verdana, "Sans";page-break-after:avoid;}h1 > code, h2 > code, h3 > code, h4 > code, h5 > code, h6 > code{font-size:100%;}h2{border-bottom:1pt solid Silver;padding-bottom:2pt;}.h_tag{page-break-after:avoid;break-after:avoid;}abbr[title]{border-bottom:0;text-decoration:none;}a{color:black;margin:0;padding:0;vertical-align:baseline;text-decoration:none;font-style:italic;}a.autoheader_anchor{text-decoration:none;font-style:normal;page-break-after:avoid;break-after:avoid;}ul{list-style-type:square;}ul, ol{padding:0;margin:0;}li > ul, ol{padding-bottom:0;}li{line-height:1.3;margin-left:13pt;margin-bottom:5pt;}ul > li{margin-left:10pt;}li ul{margin-left:5pt;}li ul{margin-left:3pt;}li p{padding:1pt 0 0 0;margin:5pt 0 3pt 0;line-height:1.3;}p, ul, ol{line-height:1.3;padding:4pt 0 0 0;margin:0;color:black;}pre{padding:3pt;margin:5pt 0;white-space:pre-wrap;background-color:#FAFAFA;border:1pt Silver solid;display:block;font-family:APLFont, monospace;page-break-inside:avoid;-webkit-print-color-adjust:exact;}pre code{background-color:#FAFAFA;color:Black;padding:0;margin:0 0 -6pt 0;line-height:1.1;border:0;}code{font-family:APLFont, monospace;line-height:1.2;font-size:9pt;padding:3pt 1pt 3pt 1pt;color:#950000;padding:3pt 4pt 3pt 4pt;}tbody th, tfoot tr{background-color:#e6e6e6;}tbody tr:nth-child(even){background-color:#fafafa;}th{background-color:#F0F0F0;}th, td{padding:1pt 5pt;}table{margin:10pt 0;font-family:APLFont;font-size:9pt;padding:0;border:1pt solid silver;-webkit-print-color-adjust:exact;}li > table{margin:10pt 0 10pt 0;}tr{margin:20pt;}th{font-weight:bold;}tfoot td{font-weight:bold;}blockquote{border-left:5pt solid silver;padding-left:5pt;margin:8pt 3pt 8pt 8pt;}nav{background-color:#f8f8f8;border:1pt solid Gray;width:auto;float:right;padding:5pt 5pt 5pt 0;margin:5pt 0 5pt 5pt;page-break-inside:avoid;}nav *{font-size:75%;}nav ul{list-style-type:none;margin:0 0 2pt 0;padding:0;}nav ul li{margin-bottom:0;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{font-size:9pt;line-height:1;padding:0;margin-top:0;margin-bottom:0;margin-left:8pt;}dl{margin-top:0;margin-bottom:10pt;}dt{margin-top:10pt;margin-bottom:0;font-weight:800;page-break-inside:avoid;}dd{margin-top:2pt;}label#hide_toc_label{font-size:65%;}.toc-container{position:relative;height:auto;margin-top:5pt;}.toc-container h1{margin:0 0 7pt 7pt;}[type="checkbox"]{display:none;}label{display:block;width:100%;height:1.1em;top:0;padding-left:10pt;}label:before{content:'Table of contents';font-weight:bold;font-size:140%;padding-bottom:10pt;}a.external_link::before{content:" 🌎";}a.bookmark_link::before{content:" ➯";}a.mailto_link::before{content:" ✉"}nav a.bookmark_link{font-style:normal;}nav p{margin-left:10pt;font-weight:bold;font-size:9pt;}nav a{font-style:normal;}nav a.bookmark_link::before{content:"";}div#footnotes_div a::before{content:"";}div#footnotes_div a{font-style:normal;}div#footnotes_div{page-break-inside:avoid;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("http://misc.aplteam.com/apl385.ttf") format("truetype");}.no_print{display:none;}.red{color:red;}.avoid_page_break{page-break-inside:avoid;}.page_break_before{page-break-before:auto;}div.leanpub{margin:10pt 0 10pt 8pt;page-break-inside:avoid;}div.leanpub_A{border:1pt solid black;background-color:#f9f9f9;padding:5pt;margin:10pt 0 10pt 0;page-break-inside:avoid;}div.leanpub h3, div.leanpub_A h3{font-size:1.2em;padding:3pt 0 0 0;margin:0;}div.leanpub h4, div.leanpub_A h4{font-size:1.1em;padding:3pt 0 0 0;margin:0;}div.leanpub h5, div.leanpub h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub_A h5, div.leanpub_A h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 10pt 2pt 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub > div > h1:first-child{padding-top:5pt;}div.leanpub img{float:left;padding:0;margin:5pt 10pt 0 0;clear:both;}div.leanpub p{padding:3pt 0 0 0;margin:0;}span.leanpub_code{color:black;}div.leanpub p{display:block;padding:8pt 0 0 0;}div.leanpub > div{margin-left:35pt;}
</style>
<meta name="author" content="kai">
</head>
<body>
<div class="h_tag">
<a href="#APM---APL-Package-Manager" id="APM---APL-Package-Manager" class="autoheader_anchor">
<h1>APM - APL Package Manager</h1>
</a>
</div>
<div class="h_tag">
<a href="#Introduction" id="Introduction" class="autoheader_anchor">
<h2>Introduction</h2>
</a>
</div>
<p>APM aims to provide a complete framework for sharing APL code.</p>
<p>A proof of concept has been implemented by using JavaScript's own package management framework: <a href="https://docs.npmjs.com/" class="external_link">npmjs</a>. This is a largely un-opinionated framework and after some experimentation it proved to be easy to set up and use for APL code as well. APM was built on top of the following components:</p>
<ul>
<li><a href="https://www.verdaccio.org/" class="external_link">verdaccio</a> - A private npm registry. This can be installed locally (on your own machine or an office server) and/or in the cloud.
<p>It can also be configured to act as a proxy, so you can host packages in a private registry with a fallback strategy on a public registry.</p></li>
<li><a href="https://pnpm.js.org/en/" class="external_link">pnpm</a> - An efficient npm client that organises package dependencies in a fast, secure and predictable way.</li>
<li><a href="https://github.com/the-carlisle-group/Acre-Desktop" class="external_link">Acre-Desktop</a> - An APL project framework developed and maintained by The Carlisle Group.</li>
<li><a href="https://www.dyalog.com" class="external_link">Dyalog</a> - APM requires Dyalog v17.0.</li>
</ul>
<div class="h_tag">
<a href="#Installation" id="Installation" class="autoheader_anchor">
<h2>Installation</h2>
</a>
</div>
<p>To start using APM you will need to install the client-side components in addition to the APM script from this repository.</p>
<div class="h_tag">
<a href="#NodeJS--npm" id="NodeJS--npm" class="autoheader_anchor">
<h3>NodeJS &amp; npm</h3>
</a>
</div>
<ol start="1">
<li>Download and install <a href="https://nodejs.org/en/" class="external_link">nodejs</a>. This includes both the node framework and the npm client which are required to interact with the registry.</li>
<li>Open a command prompt and verify that the installation was successful by issuing the command <code>npm -v</code>. This should return the current version of the npm client.</li>
</ol>
<div class="h_tag">
<a href="#pnpm" id="pnpm" class="autoheader_anchor">
<h3>pnpm</h3>
</a>
</div>
<ol start="3">
<li>Now install version 2 of pnpm by issuing the command <code>npm i pnpm@2 -g</code>.</li>
<li>Verify the installation with <code>pnpm -v</code> which should return the version number of the pnpm client.</li>
</ol>
<div class="h_tag">
<a href="#Acre-Desktop" id="Acre-Desktop" class="autoheader_anchor">
<h3>Acre-Desktop</h3>
</a>
</div>
<p>Follow the instructions on <a href="https://github.com/the-carlisle-group/Acre-Desktop" class="external_link">Acre-Dektop's project page</a>.</p>
<div class="h_tag">
<a href="#APM" id="APM" class="autoheader_anchor">
<h3>APM</h3>
</a>
</div>
<ol start="5">
<li>Download the <code>APM.dyalog</code> script and install it as a user command for Dyalog.
<p>If you place the script in <code>C:\Users\me\Documents\MyUCMDs\APM.dyalog</code> it will be found by any 17.0 installation because from 17.0 onwards this folder is one of the places scanned for user commands anyway.</p>
<p>If you want to put it into, say, <code>C:\elsewhere</code> then you must add this path to the list of folders scanned for user commands by something like this:</p>
<pre><code>      ]settings cmddir ,C:\elsewhere</code></pre></li>
</ol>
<div class="h_tag">
<a href="#verdaccio" id="verdaccio" class="autoheader_anchor">
<h3>verdaccio</h3>
</a>
</div>
<p>A public registry is hosted on <a href="https://apm.theaplroom.com/" class="external_link">https://apm.theaplroom.com/</a> and you can immediately test the setup by trying to create an account there.</p>
<p>Optionally, you can run your own registry by installing verdaccio and running it. To do that, open a new command shell and execute the following 2 commands (see instructions on the <a href="https://github.com/verdaccio/verdaccio" class="external_link">verdaccio project's page</a>):</p>
<ol start="1">
<li>Install verdaccio with <code>pnpm i -g verdaccio</code></li>
<li>Run it with <code>verdaccio</code></li>
</ol>
<p>To test the registry, create an account by following these steps:</p>
<ol start="1">
<li>Set the default registry to use by issuing <code>pnpm config set registry https://apm.theaplroom.com/</code>. This will only need to be done once and will be remain until changed again.</li>
<li>To create an account on the registry, issue <code>pnpm login</code>. You will be prompted for a username, password and email.</li>
</ol>
<div class="h_tag">
<a href="#Usage" id="Usage" class="autoheader_anchor">
<h2>Usage</h2>
</a>
</div>
<div class="h_tag">
<a href="#Create-your-first-Project" id="Create-your-first-Project" class="autoheader_anchor">
<h3>Create your first Project</h3>
</a>
</div>
<p>To get started, we'll create a project called <code>MyProject</code> in the directory <code>/path/to/projects/</code>. When following the instructions replace the name and path with whatever you like and/or is appropriate on your machine.</p>
<p>In a Dyalog 17.0 session, create a new project by calling:</p>
<pre><code>      ]APM.CreateProject /path/to/projects/MyProject #.MyProject
Added script "quadVars"
Project my-project created
Current directory set to C:/Users/gil/MyProject/
Install packages using ]APM.AddPackage</code></pre>
<p>This will create a project folder on disk and also set it as the current directory for the duration of the session. It also opens the project and tracks changes to it using Acre. We can confirm that it works by creating a function in the project space:</p>
<pre><code>      )ED MyProject.Hello</code></pre>
<p>And write a few lines:</p>
<pre><code>r←Hello name

r←'Hello ',name</code></pre>
<p>Now fix the function and you should see a message from Acre in the session:</p>
<pre><code>Saved: #.MyProject.Hello</code></pre>
<p>Let's surprise the user by adding the number of days until next Easter in the above function. Is there a package that could help us with that?</p>
<pre><code>      ]APM.FindPackage date
NAME        | DESCRIPTION         | AUTHOR      | DATE       | VERSION  | KEYWORDS
dateandtime | DateAndTime offers… | =Kai Jaeger | 2018-07-25 | 1.5.2    | date time APL</code></pre>
<p>Looks like there is a date package. To install a package we simpy call <code>]APM.AddPackage</code> with a list of package names to install:</p>
<pre><code>      ]APM.AddPackage dateandtime
Packages: +1
+
Resolving: total 1, reused 1, downloaded 0, done

dependencies:
+ dateandtime 1.5.2</code></pre>
<p>This will install the latest version available of the dateandtime package in our project folder. We now refresh the workspace by running <code>]APM.loadproject .</code></p>
<p>This checks the project folder for dependencies and makes sure to link them into the project space in the workspace.</p>
<p>With the package added and the project reloaded we can now edit the function again and extend it.</p>
<pre><code>      )ED MyProject.Hello</code></pre>
<p>Add the 3 lines in the bottom.</p>
<pre><code> r←Hello name;easterDays;nextEaster

 r←'Hello ',name

 easterDays←DateAndTime.(DateTime2DayDecimal Easter 0 1+1↑⎕TS)
 nextEaster←0~⍨0⌈⌊easterDays-DateAndTime.Timestamp2DayDecimal ⎕TS
 r,←'. Next Easter is coming up in ',(⍕nextEaster),' days.'</code></pre>
<p>Fix the function and try it out:</p>
<pre><code>Saved: #.MyProject.Hello
      #.MyProject.Hello 'Gil'
Hello Gil. Next Easter is coming up in 269 days.</code></pre>
<p>We can inspect the workspace structure by issuing the command <code>]map</code>.</p>
<pre><code>      ]map
#
·   MyProject
·   ·   ∇ Hello
·   ·   AcreConfig → #.[Namespace]
·   ·   DateAndTime → #.__packages.dateandtime_1_5_2.DateAndTime
·   ·   __apm → #.[Namespace]
·   ·   quadVars
·   __packages
·   ·   dateandtime_1_5_2
·   ·   ·   AcreConfig → #.[Namespace]
·   ·   ·   DateAndTime [Class]
·   ·   ·   __apm → #.[Namespace]</code></pre>
<p>Here we see our project space <code>MyProject</code> in the root and also that it contains a function <code>Hello</code>, three references to other spaces and finally a namespace called <code>quadVars</code>.</p>
<p>Note how the package <code>DateAndTime</code> we've added has been installed in a separate tree called <code>__packages</code>, and that a reference has been created to it in our project space. This is how packages are made available to the dependant project.</p>
</body>
</html>